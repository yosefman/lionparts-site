{%- comment -%}
  Updated: 04/26/2022
  This file is system-generated and should not be modified
  We reserve the right to overwrite it at any moment to add improvements or new features so that customizations you made might be lost
{%- endcomment -%}
{% assign zp_template_suffix = template.suffix %}{% if zp_template_suffix contains 'zipifypages' %}{% assign zp_entity_marker = template.name %}{% if zp_entity_marker == 'article' %}{% assign zp_current_entity = article %}{% elsif zp_entity_marker == 'blog' %}{% assign zp_current_entity = blog %}{% elsif zp_entity_marker == 'page' %}{% assign zp_current_entity = page %}{% elsif zp_entity_marker == 'product' %}{% assign zp_current_entity = product %}{% else %}{% assign zp_current_entity = nil %}{% endif %}{% if zp_current_entity != blank %}{% assign zp_current_entity_metafields = zp_current_entity.metafields['zipifypages'] %}{% if zp_current_entity_metafields['splittest'] != blank and zp_current_entity_metafields['splittest'].type == 'json' %}{% assign zp_split_test_data = zp_current_entity_metafields['splittest'].value %}{% assign zp_split_test_type = zp_split_test_data.type %}{% if zp_split_test_type == 'redirect' or zp_split_test_type == 'viewtyperedirect' %}{% assign zp_alternative_entity_handle = '' | append: zp_split_test_data.alternative_handle %}{% assign zp_split_dataset = zp_split_test_data.dataset | json %}{% assign zp_split_dataset = '' | append: zp_split_dataset %}{% assign zp_split_data_string = '{' %}{% assign zp_replacement_value = zp_entity_marker | json %}{% assign zp_split_data_string = zp_split_data_string | append: 'entityMarker:' | append: zp_replacement_value %}{% assign zp_replacement_value = zp_split_test_data.token | json %}{% assign zp_split_data_string = zp_split_data_string | append: ',testToken:' | append: zp_replacement_value %}{% assign zp_replacement_value = zp_split_test_type | json %}{% assign zp_split_data_string = zp_split_data_string | append: ',testType:' | append: zp_replacement_value %}{% assign zp_replacement_value = zp_current_entity.handle | json %}{% assign zp_split_data_string = zp_split_data_string | append: ',handles:{main:' | append: zp_replacement_value %}{% assign zp_view_type_url_param_name = 'view' %}{% if zp_split_test_type == 'viewtyperedirect' %}{% assign zp_replacement_value = zp_current_entity.handle | append: '?' | append: zp_view_type_url_param_name | append: '=' | append: zp_split_test_data.view_type | json %}{% else %}{% assign zp_replacement_value = zp_alternative_entity_handle | json %}{% endif %}{% assign zp_split_data_string = zp_split_data_string | append: ',alternative:' | append: zp_replacement_value %}{% assign zp_replacement_value = zp_split_dataset | json %}{% assign zp_split_data_string = zp_split_data_string | append: '},dataSet:' | append: zp_replacement_value %}{% if zp_split_test_type == 'viewtyperedirect' %}{% assign zp_replacement_value = zp_split_test_data.view_type | json %}{% assign zp_split_data_string = zp_split_data_string | append: ',viewType:' | append: zp_replacement_value %}{% endif %}{% assign zp_replacement_value = routes.root_url | json %}{% assign zp_split_data_string = zp_split_data_string | append: ',locale:{root:' | append: zp_replacement_value | append: '}}' %}{% assign zp_replacement_value = nil %}{% assign zp_split_dataset = nil %}<script>!function(t){function e(t){this.defaultVariation="a";try{this.data=JSON.parse(t)}catch(t){this.data=null}}function n(){}function i(){this.storage=new n}function r(t,e){this.mainState="main",this.scopes={"article":"articles","blog":"blogs","page":"pages","product":"products"},this.testToken=""+e,this.entityType=""+t,this.availableStates={a:"main",b:"alternative"},this.stateStorage=new i,this.state=this.getStoredState()}function a(t){this.localeData=t}function p(t){this.locale=new a(t)}function o(t,e,n,i,r,a,o,s,h){this.state=t,this.scope=e,this.handles=i,this.titles=r,this.styles=a,this.wrapperClasses=o,this.fonts=s,this.analyticsSettings=h,this.route=new p(n)}function s(){}e.prototype.selectVariation=function(){if(!this.data)return this.defaultVariation;try{var t,e=[];for(o in this.data)this.data.hasOwnProperty(o)&&(t=parseFloat(this.data[o]),isNaN(t)||e.push([t,o]));if(1<e.length){for(var n,i,r=0,a=null,o=0,s=e.length;o<s;o++)r+=e[o][0];for(i=Math.random()*r,o=0,s=e.length;o<s;o++){if(i<=(n=e[o][0])){a=e[o][1];break}i-=n}return a||this.defaultVariation}return this.defaultVariation}catch(t){return console.error("selectVariation error",t),this.defaultVariation}},n.prototype.getItem=function(t){t=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},n.prototype.setItem=function(t,e,n){var i,r=(n=n||{}).expires;"number"==typeof r&&r&&((i=new Date).setTime(i.getTime()+1e3*r),r=n.expires=i),r&&r.toUTCString&&(n.expires=r.toUTCString());var a,o,s=t+"="+(e=encodeURIComponent(e));for(a in n)n.hasOwnProperty(a)&&(s+="; "+a,!0!==(o=n[a])&&(s+="="+o));document.cookie=s},n.prototype.removeItem=function(t){this.setItem(t,"",{expires:-1})},i.prototype.getItem=function(){return this.storage.getItem.apply(this.storage,arguments)},i.prototype.setItem=function(){this.storage.setItem.apply(this.storage,arguments)},r.prototype.getAvailableState=function(t){return this.availableStates[t]||this.mainState},r.prototype._getStoredKey=function(){return"zpCurrentState"+this.entityType+this.testToken},r.prototype.getState=function(){return this.state},r.prototype.setState=function(t){return this.state=t,this.stateStorage.setItem(this._getStoredKey(),this.state),this.state},r.prototype.setMainState=function(){return this.setState(this.mainState)},r.prototype.getStoredState=function(){return this.stateStorage.getItem(this._getStoredKey())},r.prototype.currentScope=function(){return this.scopes[this.entityType]},r.prototype.isMainState=function(){return this.getState()===this.mainState},r.prototype.getMainStateValue=function(){return this.mainState},a.prototype.rootPath=function(){return this.localeData.root},a.prototype.baseRootPath=function(){return"/"},a.prototype.isChanged=function(){return this.baseRootPath()!==this.rootPath()},p.prototype.getRequestPath=function(t){return this.locale.isChanged()?this.locale.rootPath()+t:t},o.prototype.setState=function(t){return this.state=t,this.state},o.prototype.entityHandle=function(){return this.handles[this.state]},o.prototype.entityTitle=function(){return this.titles[this.state]},o.prototype.entityStylesLink=function(){return this.styles[this.state]},o.prototype.entityWrapperClasses=function(){return this.wrapperClasses[this.state]},o.prototype.entityFontsSettings=function(){return this.fonts[this.state]},o.prototype.entityAnalyticsSettings=function(){return this.analyticsSettings[this.state]},o.prototype.entityPath=function(){if(this.scope&&this.entityHandle()){var t="/"+this.scope+"/"+this.entityHandle();return this.route.getRequestPath(t)}return null},o.prototype.entityUrl=function(){var t=this.entityPath();return t?"https://{{ shop.domain }}"+t:null},s.prototype.parseUrl=function(t){var e=(""+t).trim();if(!/^\//.test(e)&&!/^https?:\/\//.test(e))return{};e=document.createElement("a");return e.href=t,{protocol:e.protocol,host:e.host,hostname:e.hostname,port:e.port,pathname:e.pathname,hash:e.hash,search:e.search,origin:e.origin}},s.prototype.searchQueryParams=function(t){t=this.parseUrl(t);return t.search?(""+t.search).replace(/^\?+/,""):""},s.prototype.filterSearchParams=function(t,e){if(!(t&&e instanceof RegExp))return t;for(var n,i=(""+(""+t).replace(/^\?+/,"")).split("&"),r=[],a=0,o=i.length;a<o;a++)n=i[a],e.test(n)||r.push(n);return r.join("&")};var h=new r(t.entityMarker,t.testToken);if(h.getState()||(u=new e(t.dataSet).selectVariation(),u=h.getAvailableState(u),h.setState(u)),!h.isMainState()){if("viewtyperedirect"===t.testType){var u=(new s).searchQueryParams(window.location.href).trim();if(new RegExp("\\b{{ zp_view_type_url_param_name }}="+t.viewType+"\\b").test(u))return}t=new o(h.getState(),h.currentScope(),t.locale,t.handles,{},{},{},{},{}).entityPath();window.location.replace(t)}}({{ zp_split_data_string }});</script>{% assign zp_split_data_string = nil %}{% endif %}{% endif %}{% endif %}{% endif %}